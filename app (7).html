<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RenoCycle - Reuse Construction Materials</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
    }
    
    .container {
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    header {
      background: white;
      padding: 12px 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.4rem;
      font-weight: 700;
      color: #2d3748;
    }
    
    .logo span {
      color: #ed8936;
    }
    
    nav {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    nav button {
      padding: 8px 16px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s;
    }
    
    nav button.active {
      background: #ed8936;
      color: white;
    }
    
    nav button:not(.active) {
      background: #edf2f7;
      color: #4a5568;
    }
    
    nav button:hover:not(.active) {
      background: #e2e8f0;
    }
    
    main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    
    .view {
      display: none;
    }
    
    .view.active {
      display: block;
    }
    
    /* Dashboard Stats */
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    
    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    .stat-card h3 {
      font-size: 0.75rem;
      color: #718096;
      margin-bottom: 8px;
      text-transform: uppercase;
    }
    
    .stat-card .value {
      font-size: 1.8rem;
      font-weight: 700;
      color: #2d3748;
    }
    
    .stat-card.highlight {
      background: linear-gradient(135deg, #ed8936, #dd6b20);
    }
    
    .stat-card.highlight h3,
    .stat-card.highlight .value {
      color: white;
    }
    
    /* Form Styles */
    .form-container {
      background: white;
      padding: 25px;
      border-radius: 12px;
      max-width: 500px;
      margin: 0 auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    .form-container h2 {
      margin-bottom: 20px;
      color: #2d3748;
      font-size: 1.3rem;
      text-align: center;
    }
    
    .form-group {
      margin-bottom: 18px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-size: 0.85rem;
      color: #4a5568;
      font-weight: 500;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #ed8936;
    }
    
    .photo-upload {
      border: 2px dashed #e2e8f0;
      padding: 30px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
      transition: border-color 0.3s;
      position: relative;
      overflow: hidden;
    }
    
    .photo-upload:hover {
      border-color: #ed8936;
    }
    
    .photo-upload .icon {
      font-size: 2.5rem;
      margin-bottom: 8px;
    }
    
    .photo-upload input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    
    .photo-upload .preview-image {
      max-width: 100%;
      max-height: 150px;
      border-radius: 8px;
      object-fit: cover;
    }
    
    .photo-upload .upload-text {
      color: #a0aec0;
      font-size: 0.85rem;
    }
    
    .photo-upload .change-text {
      color: #ed8936;
      font-size: 0.8rem;
      margin-top: 8px;
    }
    
    .price-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    
    .btn-submit {
      width: 100%;
      padding: 14px;
      background: #ed8936;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .btn-submit:hover {
      background: #dd6b20;
    }
    
    /* Products Grid */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
    }
    
    .product-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    
    .product-image {
      height: 160px;
      background: #f7fafc;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3.5rem;
      overflow: hidden;
    }
    
    .product-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .product-info {
      padding: 15px;
    }
    
    .product-info h3 {
      font-size: 0.95rem;
      color: #2d3748;
      margin-bottom: 5px;
    }
    
    .product-info .category {
      font-size: 0.75rem;
      color: #a0aec0;
      margin-bottom: 10px;
    }
    
    .product-info .seller-info {
      font-size: 0.75rem;
      color: #718096;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .product-info .price {
      font-size: 1.2rem;
      font-weight: 700;
      color: #ed8936;
    }
    
    .product-info .market-price {
      font-size: 0.8rem;
      color: #a0aec0;
      text-decoration: line-through;
      margin-left: 8px;
    }
    
    .product-info .savings {
      font-size: 0.75rem;
      color: #48bb78;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .btn-buy {
      width: 100%;
      padding: 10px;
      background: #48bb78;
      color: white;
      border: none;
      border-radius: 6px;
      margin-top: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
    }
    
    .btn-buy:hover {
      background: #38a169;
    }
    
    /* Approval Table */
    .table-container {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #e2e8f0;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .table-header h3 {
      font-size: 1rem;
      color: #2d3748;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
    }
    
    .tab {
      padding: 6px 14px;
      border: none;
      background: #edf2f7;
      border-radius: 15px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .tab.active {
      background: #ed8936;
      color: white;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 14px 20px;
      text-align: left;
      border-bottom: 1px solid #f0f0f0;
      font-size: 0.85rem;
    }
    
    th {
      background: #f7fafc;
      font-weight: 600;
      color: #718096;
      font-size: 0.75rem;
      text-transform: uppercase;
    }
    
    .item-cell {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .item-thumb {
      width: 50px;
      height: 50px;
      background: #f0f0f0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      overflow: hidden;
      flex-shrink: 0;
    }
    
    .item-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .item-name {
      font-weight: 500;
      color: #2d3748;
    }
    
    .item-seller {
      font-size: 0.75rem;
      color: #a0aec0;
    }
    
    .btn-approve {
      padding: 6px 12px;
      background: #48bb78;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.8rem;
      margin-right: 6px;
      transition: background 0.3s;
    }
    
    .btn-approve:hover {
      background: #38a169;
    }
    
    .btn-reject {
      padding: 6px 12px;
      background: #fc8181;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: background 0.3s;
    }
    
    .btn-reject:hover {
      background: #e53e3e;
    }
    
    .status-badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .status-pending {
      background: #fef3c7;
      color: #d69e2e;
    }
    
    .status-approved {
      background: #c6f6d5;
      color: #38a169;
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 16px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-content h3 {
      margin-bottom: 15px;
      color: #2d3748;
    }
    
    .modal-content .modal-icon {
      font-size: 4rem;
      margin-bottom: 15px;
    }
    
    .modal-content .modal-image {
      width: 120px;
      height: 120px;
      border-radius: 12px;
      object-fit: cover;
      margin-bottom: 15px;
    }
    
    .price-breakdown {
      background: #f7fafc;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      text-align: left;
    }
    
    .price-row-modal {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .price-row-modal:last-child {
      border-bottom: none;
      font-weight: 700;
      color: #ed8936;
    }
    
    .btn-close {
      padding: 12px 30px;
      background: #e2e8f0;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      margin-right: 10px;
      transition: background 0.3s;
    }
    
    .btn-close:hover {
      background: #cbd5e0;
    }
    
    .btn-confirm {
      padding: 12px 30px;
      background: #48bb78;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
    }
    
    .btn-confirm:hover {
      background: #38a169;
    }
    
    .section-title {
      font-size: 1.1rem;
      color: #2d3748;
      margin-bottom: 20px;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #a0aec0;
    }
    
    .empty-state .icon {
      font-size: 4rem;
      margin-bottom: 15px;
    }
    
    /* Success Animation */
    .success-animation {
      animation: bounce 0.5s ease;
    }
    
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @media (max-width: 600px) {
      header {
        padding: 10px 15px;
      }
      
      .logo {
        font-size: 1.2rem;
      }
      
      nav button {
        padding: 6px 12px;
        font-size: 0.75rem;
      }
      
      main {
        padding: 15px;
      }
      
      th, td {
        padding: 10px;
        font-size: 0.75rem;
      }
      
      .price-row {
        grid-template-columns: 1fr;
      }
      
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 12px;
      }
      
      .product-image {
        height: 120px;
      }
      
      .stats {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stat-card {
        padding: 15px;
      }
      
      .stat-card .value {
        font-size: 1.4rem;
      }
    }
    
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #2d3748;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      display: none;
      z-index: 1001;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    
    .toast.show {
      display: block;
      animation: fadeIn 0.3s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(-50%) translateY(20px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }
    
    .filter-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .filter-bar select {
      padding: 8px 15px;
      border: 1px solid #e2e8f0;
      border-radius: 20px;
      font-size: 0.85rem;
      background: white;
      cursor: pointer;
    }
    
    .filter-bar input {
      padding: 8px 15px;
      border: 1px solid #e2e8f0;
      border-radius: 20px;
      font-size: 0.85rem;
      flex: 1;
      min-width: 150px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        ‚ôªÔ∏è Reno<span>Cycle</span>
      </div>
      <nav>
        <button class="active" onclick="showView('browse', this)">üõí Browse</button>
        <button onclick="showView('sell', this)">üì¶ Sell</button>
        <button onclick="showView('admin', this)">‚öôÔ∏è Admin</button>
      </nav>
    </header>
    
    <main>
      <!-- Browse View -->
      <div id="browse" class="view active">
        <h2 class="section-title">Browse Materials</h2>
        <div class="filter-bar">
          <input type="text" id="searchInput" placeholder="üîç Search materials..." oninput="filterProducts()">
          <select id="categoryFilter" onchange="filterProducts()">
            <option value="">All Categories</option>
            <option value="Tiles & Flooring">Tiles & Flooring</option>
            <option value="Wood & Lumber">Wood & Lumber</option>
            <option value="Bricks & Blocks">Bricks & Blocks</option>
            <option value="Plumbing">Plumbing</option>
            <option value="Electrical">Electrical</option>
            <option value="Paint & Finish">Paint & Finish</option>
            <option value="Fixtures">Fixtures</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="products-grid" id="productsGrid">
          <!-- Products will be rendered here -->
        </div>
      </div>
      
      <!-- Sell View -->
      <div id="sell" class="view">
        <div class="form-container">
          <h2>üì¶ List Item for Sale</h2>
          <form id="sellForm" onsubmit="submitListing(event)">
            <div class="form-group">
              <label>Item Photo *</label>
              <div class="photo-upload" id="photoUpload">
                <input type="file" id="imageInput" accept="image/*" onchange="handleImageUpload(event)" required>
                <div id="uploadPlaceholder">
                  <div class="icon">üì∑</div>
                  <div class="upload-text">Click or drag to upload image</div>
                  <div style="font-size: 0.75rem; color: #cbd5e0; margin-top: 5px;">JPG, PNG up to 5MB</div>
                </div>
                <div id="imagePreview" style="display: none;">
                  <img id="previewImg" class="preview-image" src="" alt="Preview">
                  <div class="change-text">Click to change image</div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Product Title *</label>
              <input type="text" id="productTitle" placeholder="e.g., Leftover Granite Slab" required>
            </div>
            <div class="form-group">
              <label>Category *</label>
              <select id="category" required>
                <option value="">Select category</option>
                <option value="Tiles & Flooring">Tiles & Flooring</option>
                <option value="Wood & Lumber">Wood & Lumber</option>
                <option value="Bricks & Blocks">Bricks & Blocks</option>
                <option value="Plumbing">Plumbing</option>
                <option value="Electrical">Electrical</option>
                <option value="Paint & Finish">Paint & Finish</option>
                <option value="Fixtures">Fixtures</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="price-row">
              <div class="form-group">
                <label>Sell Price (‚Çπ) *</label>
                <input type="number" id="sellPrice" placeholder="0" required min="1">
              </div>
              <div class="form-group">
                <label>Market Price (‚Çπ)</label>
                <input type="number" id="marketPrice" placeholder="0" min="0">
              </div>
            </div>
            <div class="form-group">
              <label>Description</label>
              <textarea id="description" rows="3" placeholder="Describe the condition, quantity, dimensions..."></textarea>
            </div>
            <div class="form-group">
              <label>Seller Name *</label>
              <input type="text" id="sellerName" placeholder="Your name" required>
            </div>
            <div class="form-group">
              <label>Contact Number *</label>
              <input type="tel" id="sellerPhone" placeholder="Your phone number" required>
            </div>
            <button type="submit" class="btn-submit">Submit for Approval</button>
          </form>
        </div>
      </div>
      
      <!-- Admin View -->
      <div id="admin" class="view">
        <div class="stats">
          <div class="stat-card">
            <h3>Pending</h3>
            <div class="value" id="pendingCount">0</div>
          </div>
          <div class="stat-card">
            <h3>Active Listings</h3>
            <div class="value" id="activeCount">0</div>
          </div>
          <div class="stat-card">
            <h3>Total Sales</h3>
            <div class="value" id="totalSales">0</div>
          </div>
          <div class="stat-card">
            <h3>Gross Sales</h3>
            <div class="value" id="grossSales">‚Çπ0</div>
          </div>
          <div class="stat-card highlight">
            <h3>Net Revenue (10%)</h3>
            <div class="value" id="netRevenue">‚Çπ0</div>
          </div>
        </div>
        
        <div class="table-container">
          <div class="table-header">
            <h3>üìã Manage Listings</h3>
            <div class="tabs">
              <button class="tab active" onclick="filterAdmin('pending', this)">Pending</button>
              <button class="tab" onclick="filterAdmin('approved', this)">Approved</button>
              <button class="tab" onclick="filterAdmin('all', this)">All</button>
            </div>
          </div>
          <div style="overflow-x: auto;">
            <table>
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Price</th>
                  <th>Commission (10%)</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="adminTable">
                <!-- Items will be rendered here -->
              </tbody>
            </table>
          </div>
          <div class="empty-state" id="emptyAdmin" style="display: none;">
            <div class="icon">üìã</div>
            <div>No items to display</div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Purchase Modal -->
  <div class="modal" id="purchaseModal">
    <div class="modal-content">
      <div id="modalImageContainer"></div>
      <h3 id="modalItemName"></h3>
      <p id="modalItemDesc" style="color: #718096; font-size: 0.9rem; margin-bottom: 10px;"></p>
      <div class="price-breakdown">
        <div class="price-row-modal">
          <span>Item Price</span>
          <span id="modalItemPrice">‚Çπ0</span>
        </div>
        <div class="price-row-modal">
          <span>Platform Fee (10%)</span>
          <span id="modalFee">‚Çπ0</span>
        </div>
        <div class="price-row-modal">
          <span>Total Amount</span>
          <span id="modalTotal">‚Çπ0</span>
        </div>
      </div>
      <p id="modalSeller" style="color: #718096; font-size: 0.85rem; margin-bottom: 15px;"></p>
      <button class="btn-close" onclick="closeModal()">Cancel</button>
      <button class="btn-confirm" onclick="confirmPurchase()">Confirm Purchase</button>
    </div>
  </div>
  
  <!-- Success Modal -->
  <div class="modal" id="successModal">
    <div class="modal-content">
      <div class="modal-icon success-animation">üéâ</div>
      <h3>Purchase Successful!</h3>
      <p style="color: #718096; margin: 15px 0;">Thank you for your purchase. The seller will contact you shortly.</p>
      <button class="btn-confirm" onclick="closeSuccessModal()">Done</button>
    </div>
  </div>
  
  <!-- Toast -->
  <div class="toast" id="toast"></div>
  
  <script>
    // Data Store
    let items = [
      { 
        id: 1, 
        title: 'Teak Wood Planks (10 pcs)', 
        category: 'Wood & Lumber', 
        price: 4500, 
        marketPrice: 6000, 
        image: null,
        emoji: 'ü™µ',
        seller: 'Rahul Kumar', 
        phone: '9876543210',
        description: 'High quality teak wood planks, slightly used, perfect for furniture.',
        status: 'approved' 
      },
      { 
        id: 2, 
        title: 'Marble Floor Tiles (20 sqft)', 
        category: 'Tiles & Flooring', 
        price: 2100, 
        marketPrice: 3500, 
        image: null,
        emoji: 'ü™®',
        seller: 'Priya Sharma', 
        phone: '9876543211',
        description: 'Italian marble tiles, white with grey veins. Leftover from renovation.',
        status: 'approved' 
      },
      { 
        id: 3, 
        title: 'Ceramic Wash Basin', 
        category: 'Plumbing', 
        price: 1200, 
        marketPrice: 2000, 
        image: null,
        emoji: 'üöø',
        seller: 'Amit Verma', 
        phone: '9876543212',
        description: 'Brand new ceramic wash basin, white color, still in packaging.',
        status: 'pending' 
      },
      { 
        id: 4, 
        title: 'Red Clay Bricks (100 pcs)', 
        category: 'Bricks & Blocks', 
        price: 800, 
        marketPrice: 1200, 
        image: null,
        emoji: 'üß±',
        seller: 'Suresh Mehta', 
        phone: '9876543213',
        description: 'Good quality red clay bricks, leftover from construction.',
        status: 'pending' 
      },
    ];
    
    let grossSalesAmount = 0;
    let totalSalesCount = 0;
    let currentPurchaseItem = null;
    let currentAdminFilter = 'pending';
    let uploadedImageData = null;
    
    // View Navigation
    function showView(viewName, btn) {
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
      document.getElementById(viewName).classList.add('active');
      btn.classList.add('active');
      
      if (viewName === 'browse') renderProducts();
      if (viewName === 'admin') renderAdmin();
    }
    
    // Handle Image Upload
    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (file) {
        if (file.size > 5 * 1024 * 1024) {
          showToast('Image size should be less than 5MB');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
          uploadedImageData = e.target.result;
          document.getElementById('uploadPlaceholder').style.display = 'none';
          document.getElementById('imagePreview').style.display = 'block';
          document.getElementById('previewImg').src = uploadedImageData;
        };
        reader.readAsDataURL(file);
      }
    }
    
    // Reset Image Upload
    function resetImageUpload() {
      uploadedImageData = null;
      document.getElementById('uploadPlaceholder').style.display = 'block';
      document.getElementById('imagePreview').style.display = 'none';
      document.getElementById('previewImg').src = '';
      document.getElementById('imageInput').value = '';
    }
    
    // Filter Products
    function filterProducts() {
      renderProducts();
    }
    
    // Render Products
    function renderProducts() {
      const grid = document.getElementById('productsGrid');
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const categoryFilter = document.getElementById('categoryFilter').value;
      
      let approvedItems = items.filter(i => i.status === 'approved');
      
      if (searchTerm) {
        approvedItems = approvedItems.filter(i => 
          i.title.toLowerCase().includes(searchTerm) ||
          i.category.toLowerCase().includes(searchTerm) ||
          (i.description && i.description.toLowerCase().includes(searchTerm))
        );
      }
      
      if (categoryFilter) {
        approvedItems = approvedItems.filter(i => i.category === categoryFilter);
      }
      
      if (approvedItems.length === 0) {
        grid.innerHTML = `
          <div class="empty-state" style="grid-column: 1/-1;">
            <div class="icon">üì¶</div>
            <div>No materials found</div>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = approvedItems.map(item => {
        const savings = item.marketPrice ? Math.round((1 - item.price / item.marketPrice) * 100) : 0;
        return `
          <div class="product-card">
            <div class="product-image">
              ${item.image ? `<img src="${item.image}" alt="${item.title}">` : item.emoji}
            </div>
            <div class="product-info">
              <h3>${item.title}</h3>
              <div class="category">${item.category}</div>
              <div class="seller-info">üë§ ${item.seller}</div>
              <div>
                <span class="price">‚Çπ${item.price.toLocaleString()}</span>
                ${item.marketPrice ? `<span class="market-price">‚Çπ${item.marketPrice.toLocaleString()}</span>` : ''}
                ${savings > 0 ? `<span class="savings">${savings}% off</span>` : ''}
              </div>
              <button class="btn-buy" onclick="buyItem(${item.id})">Buy Now</button>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // Render Admin Table
    function renderAdmin() {
      const tbody = document.getElementById('adminTable');
      const emptyState = document.getElementById('emptyAdmin');
      
      let filteredItems = items;
      if (currentAdminFilter === 'pending') {
        filteredItems = items.filter(i => i.status === 'pending');
      } else if (currentAdminFilter === 'approved') {
        filteredItems = items.filter(i => i.status === 'approved');
      }
      
      // Update stats
      document.getElementById('pendingCount').textContent = items.filter(i => i.status === 'pending').length;
      document.getElementById('activeCount').textContent = items.filter(i => i.status === 'approved').length;
      document.getElementById('totalSales').textContent = totalSalesCount;
      document.getElementById('grossSales').textContent = '‚Çπ' + grossSalesAmount.toLocaleString();
      document.getElementById('netRevenue').textContent = '‚Çπ' + Math.round(grossSalesAmount * 0.1).toLocaleString();
      
      if (filteredItems.length === 0) {
        tbody.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }
      
      emptyState.style.display = 'none';
      tbody.innerHTML = filteredItems.map(item => `
        <tr>
          <td>
            <div class="item-cell">
              <div class="item-thumb">
                ${item.image ? `<img src="${item.image}" alt="${item.title}">` : item.emoji}
              </div>
              <div>
                <div class="item-name">${item.title}</div>
                <div class="item-seller">üë§ ${item.seller} ‚Ä¢ üìû ${item.phone}</div>
              </div>
            </div>
          </td>
          <td>‚Çπ${item.price.toLocaleString()}</td>
          <td style="color: #48bb78; font-weight: 600;">‚Çπ${Math.round(item.price * 0.1).toLocaleString()}</td>
          <td>
            <span class="status-badge ${item.status === 'pending' ? 'status-pending' : 'status-approved'}">
              ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
            </span>
          </td>
          <td>
            ${item.status === 'pending' ? `
              <button class="btn-approve" onclick="approveItem(${item.id})">‚úì Approve</button>
              <button class="btn-reject" onclick="rejectItem(${item.id})">‚úï Reject</button>
            ` : '<span style="color: #a0aec0;">‚Äî</span>'}
          </td>
        </tr>
      `).join('');
    }
    
    // Filter Admin
    function filterAdmin(filter, btn) {
      currentAdminFilter = filter;
      document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
      btn.classList.add('active');
      renderAdmin();
    }
    
    // Approve Item
    function approveItem(id) {
      const item = items.find(i => i.id === id);
      if (item) {
        item.status = 'approved';
        showToast('‚úì Item approved successfully!');
        renderAdmin();
      }
    }
    
    // Reject Item
    function rejectItem(id) {
      if (confirm('Are you sure you want to reject this item?')) {
        items = items.filter(i => i.id !== id);
        showToast('Item rejected');
        renderAdmin();
      }
    }
    
    // Buy Item
    function buyItem(id) {
      currentPurchaseItem = items.find(i => i.id === id);
      if (currentPurchaseItem) {
        const imageContainer = document.getElementById('modalImageContainer');
        if (currentPurchaseItem.image) {
          imageContainer.innerHTML = `<img src="${currentPurchaseItem.image}" class="modal-image" alt="${currentPurchaseItem.title}">`;
        } else {
          imageContainer.innerHTML = `<div class="modal-icon">${currentPurchaseItem.emoji}</div>`;
        }
        
        document.getElementById('modalItemName').textContent = currentPurchaseItem.title;
        document.getElementById('modalItemDesc').textContent = currentPurchaseItem.description || '';
        document.getElementById('modalItemPrice').textContent = '‚Çπ' + currentPurchaseItem.price.toLocaleString();
        document.getElementById('modalFee').textContent = '‚Çπ' + Math.round(currentPurchaseItem.price * 0.1).toLocaleString();
        document.getElementById('modalTotal').textContent = '‚Çπ' + Math.round(currentPurchaseItem.price * 1.1).toLocaleString();
        document.getElementById('modalSeller').textContent = `Seller: ${currentPurchaseItem.seller} ‚Ä¢ ${currentPurchaseItem.phone}`;
        document.getElementById('purchaseModal').classList.add('active');
      }
    }
    
    // Confirm Purchase
    function confirmPurchase() {
      if (currentPurchaseItem) {
        grossSalesAmount += currentPurchaseItem.price;
        totalSalesCount++;
        items = items.filter(i => i.id !== currentPurchaseItem.id);
        closeModal();
        document.getElementById('successModal').classList.add('active');
        renderProducts();
      }
    }
    
    // Close Modal
    function closeModal() {
      document.getElementById('purchaseModal').classList.remove('active');
      currentPurchaseItem = null;
    }
    
    // Close Success Modal
    function closeSuccessModal() {
      document.getElementById('successModal').classList.remove('active');
    }
    
    // Submit Listing
    function submitListing(e) {
      e.preventDefault();
      
      if (!uploadedImageData) {
        showToast('Please upload an image');
        return;
      }
      
      const newItem = {
        id: Date.now(),
        title: document.getElementById('productTitle').value,
        category: document.getElementById('category').value,
        price: parseInt(document.getElementById('sellPrice').value),
        marketPrice: parseInt(document.getElementById('marketPrice').value) || null,
        image: uploadedImageData,
        emoji: 'üì¶',
        seller: document.getElementById('sellerName').value,
        phone: document.getElementById('sellerPhone').value,
        description: document.getElementById('description').value,
        status: 'pending'
      };
      
      items.push(newItem);
      
      // Reset form
      document.getElementById('sellForm').reset();
      resetImageUpload();
      
      showToast('‚úì Item submitted for approval!');
    }
    
    // Toast Notification
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }
    
    // Close modals on outside click
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', function(e) {
        if (e.target === this) {
          this.classList.remove('active');
        }
      });
    });
    
    // Initial Render
    renderProducts();
  </script>
</body>
</html>
